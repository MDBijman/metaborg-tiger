module testing

imports

	api
	tiger

strategies

  flock-test-show-cfg = flock-initialize; flock-debug-graph
  
  flock-test-show-termgraph = flock-initialize; flock-debug-termgraph
  external flock-debug-termgraph(|)
  flock-test-run-pipeline: p -> p'
  with
    with-ids := <flock-initialize> p
  ; p' := <
      opt-repeat(|15)
  	; topdown(try(remove-all(?Hole())))
  > with-ids
  
  flock-test-run-inline = flock-initialize; transform-inline
  
  flock-test-run-return: p -> p'
  with
    with-ids := <flock-initialize> p
  ; <flock-enable-logging> ()
  ; p' := <
  	  flock-log(|"api")
  	; topdown(try(flock-remove-all(?Return())))
    ; opt-repeat(|3)
  	; topdown(try(flock-remove-all(?Hole())))
  > with-ids
  